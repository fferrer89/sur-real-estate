<!--Section that displays a single listing from the site-->
<section id="listing-page">
    <main id="listing">
        <article>
            {{#with listing}} <!--'with' is a handlebar helper that allows you to dive into an OBJECT, giving you access
            to its properties-->
                <h2>{{location.address}}</h2>
                <img src="../../public/uploads/{{photo}}" alt="{{location.address}} img">
                <address>
                    {{#with location}}
                        <p>Address: {{address}}, {{city}}, {{state}}, {{zip}}</p>
                    {{/with}}
                    <p>List Price: {{listingPrice}}</p>
                    <p>Square Feet: {{sqft}}</p>
                    <p>Number of Bedrooms: {{numBeds}}</p>
                    <p>Number of Bathrooms: {{numBaths}}</p>
                    <p>Includes Garage: {{hasGarage}}</p>
                    <p>Includes Terrace: {{hasTerrace}}</p>
                </address>
            {{/with}}
        </article>
        <!--Dashboard with info here-->
    </main>
    <aside>
        <section id="deposit">
            <h2>Make a Deposit</h2>
            <form action="/listings/listingId/deposit/new" method="post">
                <label>Deposit Amount:
                    <input type="number" min="1" required>
                </label>
                <button type="submit">Make Deposit</button>
            </form>
        </section>
        <section id="onsite-visit">
            <h2>Book an Onsite Visit</h2>
            <form action="/listings/listingId/visit/new" method="post">
                <label>Visit Date:
                    <input type="date" required>
                </label>
                <button type="submit">Book Visit</button>
            </form>
        </section>
        <section id="comments">
            <h2>Comments</h2>
            <!--Use Handlebars!: If user is authenticated, display the form and the comments. Otherwise, display the comments and a login link with message that "user needs to be registered to post comments"-->
            <!--            The form is only displayed for authenticated users!-->
            {{#with listing}}
                {{#if comments}}
                        {{#each comments}}
                            <ul>
                                <!--Unordered List of comments, each enclosed in an <article> tag-->
                                <li>
                                    <article>
                                        <p>{{this.user}}</p>
                                        <p>{{this.comment}}</p>
                                    </article>
                                </li>
                            </ul>
                        {{/each}}
                {{else}}
                    <p>This property has no comments yet</p>
                {{/if}}
            {{/with}}
            {{#if sessionUser}}
                <form action="./comments/new" method="post">
                    <label>Post a comment on this property:
                        <textarea name="comment" rows="2" cols="40" required></textarea>
                    </label>
                    <br>
                    <button type="submit">Post Comment</button>
                </form>
            {{else}}
                <a href="/login">Login to post a comment</a>
            {{/if}}
        </section>
        <section id="messages">
            <h2>Messages</h2>
            <form action="/listings/listingId/messages/new" method="post">
                <label>Send a message to the real estate agent:
                    <textarea name="message" rows="2" cols="40" required></textarea>
                </label>
                <br>
                <button type="submit">Send Message</button>
            </form>
                <ul>
                    <!--Unordered List of messages, each enclosed in an <article> tag-->
                </ul>
        </section>
    </aside>
</section>